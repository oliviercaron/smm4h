Loading training and development data...
Training data: 31187 samples
Development data: 4625 samples
Class distribution in training data:
0    0.92141
1    0.07859
Name: proportion, dtype: float64

Class distribution in development data:
0    0.913946
1    0.086054
Name: proportion, dtype: float64

Loading E5 model: intfloat/multilingual-e5-large...
Using device: cuda
Preparing texts with 'passage: ' prefix for E5...
Generating E5 embeddings for training data...
Generating E5 embeddings for development data...
E5 embedding generation complete. Took 183.52 seconds.
Shape of Train Embeddings: (31187, 1024)
Shape of Dev Embeddings: (4625, 1024)

Applying RandomOverSampler to balance training classes using embeddings...
Oversampling complete. New training samples: 57472
Class distribution after oversampling:
1    0.5
0    0.5
Name: proportion, dtype: float64

Training Random Forest classifier on E5 embeddings...
Training complete.

Predicting probabilities on development data using E5 embeddings...
Predictions made using threshold 0.3.

----- Detailed Evaluation on Development Set -----

Metrics for language: DE
  Precision-de (Pos): 1.0000
  Recall-de    (Pos): 0.0857
  F1-de        (Pos): 0.1579
  Accuracy-de:        0.9495

Metrics for language: EN
  Precision-en (Pos): 0.6875
  Recall-en    (Pos): 0.5410
  F1-en        (Pos): 0.6055
  Accuracy-en:        0.9523

Metrics for language: FR
  Precision-fr (Pos): 0.6667
  Recall-fr    (Pos): 0.1333
  F1-fr        (Pos): 0.2222
  Accuracy-fr:        0.9332

Metrics for language: RU
  Precision-ru (Pos): 0.6018
  Recall-ru    (Pos): 0.4890
  F1-ru        (Pos): 0.5396
  Accuracy-ru:        0.9150

----- Overall Evaluation Summary -----
F1-score across all languages (Positive Class): 0.5118  <-- Primary Metric
Macro F1-score across all languages (Pos Class):0.3813
Overall Accuracy across all languages:          0.9286

Overall Confusion Matrix (All Languages):
[[TN=4122  FP=105]
 [FN=225  TP=173]]

Logging evaluation metrics to W&B...
Metrics logged.

Saving predictions for the development set...
Predictions saved to results_e5_rf\prediction_task1_e5_rf.csv
prediction_task1_e5_rf.csv has been zipped into results_e5_rf\submission_task1_e5_rf.zip

Logging artifacts to W&B...
Artifacts logged.
