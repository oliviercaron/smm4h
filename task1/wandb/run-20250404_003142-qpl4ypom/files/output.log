Classification datasets created.
Loading tokenizer for classification phase from: results_simcse_xlmr_base
Classification datasets tokenized.
Computing class weights for classification...
Detected 2 distinct labels in training data: [0 1]
Class Weights (for classes [0 1]): [0.5426468 6.3620973]
Loading model for classification from: results_simcse_xlmr_base
Some weights of XLMRobertaForSequenceClassification were not initialized from the model checkpoint at results_simcse_xlmr_base and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Classification model loaded.
c:\Users\Olivier\AppData\Local\Programs\Python\Python312\Lib\site-packages\transformers\training_args.py:1611: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of ðŸ¤— Transformers. Use `eval_strategy` instead
  warnings.warn(
C:\Users\Olivier\AppData\Local\Temp\ipykernel_22972\1962037920.py:314: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `WeightedClassificationTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
Classification Trainer configured.
Starting classification fine-tuning...
Classification fine-tuning finished.
Best classification model and tokenizer saved to results_classifier_finetuned_on_simcse\best_model

--- Detailed Evaluation and Submission File Generation ---

Generating predictions for Threshold Adjustment and Detailed Metrics...

Finding best threshold on validation set based on Overall F1-Positive...

Best threshold found: 0.11 with Overall F1-Pos: 0.6919

--- Detailed Evaluation on Development Set (Final Predictions) ---
--- (Using Threshold = 0.11) ---

Metrics for language: DE (Support: {0: 599, 1: 35})
  Precision (Pos/1): 0.5385
  Recall    (Pos/1): 0.6000
  F1        (Pos/1): 0.5676
  Accuracy:          0.9495

Metrics for language: EN (Support: {0: 841, 1: 61})
  Precision (Pos/1): 0.7391
  Recall    (Pos/1): 0.8361
  F1        (Pos/1): 0.7846
  Accuracy:          0.9690

Metrics for language: FR (Support: {0: 389, 1: 30})
  Precision (Pos/1): 0.5610
  Recall    (Pos/1): 0.7667
  F1        (Pos/1): 0.6479
  Accuracy:          0.9403

Metrics for language: RU (Support: {0: 2398, 1: 272})
  Precision (Pos/1): 0.6600
  Recall    (Pos/1): 0.7279
  F1        (Pos/1): 0.6923
  Accuracy:          0.9341

--- Overall Evaluation Summary (Final Predictions) ---
Overall F1-score (Positive Class): 0.6919  <-- Primary Metric
Macro F1-score (Pos Class / Lang): 0.6731
Overall Precision (Positive Class):0.6526
Overall Recall (Positive Class):   0.7362
Overall Accuracy:                  0.9436

Overall Confusion Matrix (Final):
Predicted Labels: [0 1]
True Labels
[[4071  156]
 [ 105  293]]

Saving predictions for submission...
Predictions saved to results_classifier_finetuned_on_simcse\predictions_task1_simcse_finetuned_thresh0.11.csv
predictions_task1_simcse_finetuned_thresh0.11.csv has been zipped into results_classifier_finetuned_on_simcse\submission_task1_simcse_finetuned_thresh0.11.zip
